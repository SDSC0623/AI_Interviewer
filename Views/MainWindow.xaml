<ui:FluentWindow x:Class="AI_Interviewer.Views.MainWindow"
                 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                 xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
                 xmlns:tray="http://schemas.lepo.co/wpfui/2022/xaml/tray"
                 xmlns:controls="clr-namespace:AI_Interviewer.Controls"
                 xmlns:viewModels="clr-namespace:AI_Interviewer.ViewModels"
                 xmlns:homePage="clr-namespace:AI_Interviewer.Views.Pages.HomePage"
                 xmlns:settingPage="clr-namespace:AI_Interviewer.Views.Pages.SettingPage"
                 ExtendsContentIntoTitleBar="True"
                 mc:Ignorable="d"
                 d:DesignHeight="2550"
                 d:DesignWidth="692"
                 ui:Design.Background="{DynamicResource ApplicationBackgroundBrush}"
                 ui:Design.Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                 d:DataContext="{d:DesignInstance Type=viewModels:MainWindowViewModel}"
                 Title="MainWindow" Height="563" Width="1000">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>

        <ui:TitleBar Title="{Binding Title}"
                     Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2">
            <ui:TitleBar.Icon>
                <ui:ImageIcon Source="pack://application:,,,/Assets/Icons/icon.png" />
            </ui:TitleBar.Icon>
            <ui:TitleBar.TrailingContent>
                <StackPanel VerticalAlignment="Top" Orientation="Horizontal">
                    <controls:TwoStateButton Width="46" Height="32"
                                             Background="Transparent"
                                             BorderBrush="Transparent"
                                             ToolTip="切换主题颜色"
                                             EnableIcon="{ui:SymbolIcon WeatherSunny24}"
                                             EnableCommand="{Binding ChangeToDarkCommand}"
                                             DisableIcon="{ui:SymbolIcon WeatherMoon24}"
                                             DisableCommand="{Binding ChangeToLightCommand}"
                                             IsChecked="{Binding IsDark, Mode=TwoWay}" />
                    <ui:Button Width="46" Height="32"
                               Background="Transparent"
                               BorderBrush="Transparent"
                               Command="{Binding HideCommand}"
                               Icon="{ui:SymbolIcon CaretDown24}"
                               ToolTip="最小化到托盘" />
                </StackPanel>
            </ui:TitleBar.TrailingContent>
        </ui:TitleBar>

        <ui:NavigationView x:Name="RootNavigation"
                           PaneTitle="工具菜单"
                           Grid.Column="0" Grid.Row="1"
                           IsBackButtonVisible="Collapsed"
                           IsPaneToggleVisible="True"
                           OpenPaneLength="200">
            <ui:NavigationView.MenuItems>
                <!-- 主页 -->
                <ui:NavigationViewItem Content="主页"
                                       NavigationCacheMode="Enabled"
                                       TargetPageType="{x:Type homePage:HomePage}">
                    <ui:NavigationViewItem.Icon>
                        <ui:SymbolIcon Symbol="Home24" Filled="True" Height="20" Width="20" />
                    </ui:NavigationViewItem.Icon>
                </ui:NavigationViewItem>

            </ui:NavigationView.MenuItems>

            <!-- 底部菜单项 -->
            <ui:NavigationView.FooterMenuItems>
                <ui:NavigationViewItem Content="设置"
                                       NavigationCacheMode="Required"
                                       Icon="{ui:SymbolIcon Settings16}"
                                       TargetPageType="{x:Type settingPage:SettingPage}" />
            </ui:NavigationView.FooterMenuItems>
            <ui:NavigationView.ContentOverlay>
                <Grid>
                    <ui:SnackbarPresenter x:Name="SnackbarPresenter" />
                </Grid>
            </ui:NavigationView.ContentOverlay>
        </ui:NavigationView>

        <ContentPresenter x:Name="RootContentDialog" Grid.Row="1" Grid.Column="0" />

        <tray:NotifyIcon Grid.Column="0" Grid.Row="0"
                         FocusOnLeftClick="False"
                         Icon="/Assets/Icons/icon.png"
                         LeftDoubleClick="OnNotifyIconLeftDoubleClick"
                         MenuOnRightClick="True">
            <tray:NotifyIcon.Menu>
                <ContextMenu DataContext="{Binding DataContext, Source={x:Reference RootNavigation}}">
                    <ui:MenuItem Command="{Binding ShowCommand}"
                                 Icon="{ui:SymbolIcon OpenFolder24}"
                                 Header="显示主界面" d:DataContext="{d:DesignInstance viewModels:MainWindowViewModel }" />
                    <ui:MenuItem Command="{Binding ExitInTrayCommand}"
                                 Icon="{ui:SymbolIcon ArrowExit20, Filled=True}"
                                 Header="退出" d:DataContext="{d:DesignInstance viewModels:MainWindowViewModel }" />
                </ContextMenu>
            </tray:NotifyIcon.Menu>
        </tray:NotifyIcon>
    </Grid>
</ui:FluentWindow>